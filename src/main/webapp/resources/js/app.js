!function(){"use strict";var r=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,a,o=r.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)s.push(n.value)}catch(t){a={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(a)throw a.error}}return s},m=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t};var c="/image-gallery-js";function s(o,n){var s,a,i,d,l;function c(t){t.preventDefault(),t.dataTransfer.dropEffect="move";var e,r,n,a=t.target;a&&a!==s&&"DIV"==a.nodeName&&(r=(e=a.getBoundingClientRect()).right-e.width/2,n=t.clientX<l&&(t.clientX-i<r||t.clientY-d<r)?a:a.nextSibling,o.insertBefore(s,n))}function u(t){var e,r;t.preventDefault(),s.classList.remove("opacity-25","border","border-dashed"),o.removeEventListener("dragover",c),o.removeEventListener("dragend",u),e=o.children,r=e.length,m(e).forEach(function(t,e){return t.dataset.order=r-e}),a!==s.nextSibling&&n(s),m(o.children).forEach(function(t){return t.classList.add("hover:bg-blue-200")})}o.addEventListener("dragstart",function(t){s=t.target,a=s.nextElementSibling,l=t.clientX,i=t.clientX-s.getBoundingClientRect().x,s.getBoundingClientRect().right,t.clientX,d=t.clientY-s.getBoundingClientRect().top,s.getBoundingClientRect().bottom,t.clientY,m(o.children).forEach(function(t){return t.classList.remove("hover:bg-blue-200")}),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/html",s.innerHTML),o.addEventListener("dragover",c),o.addEventListener("dragend",u),setTimeout(function(){s.classList.add("opacity-25","border","border-dashed")},0)})}var n=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,a,o=r.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)s.push(n.value)}catch(t){a={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(a)throw a.error}}return s},d=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},u=(Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=new Proxy(t,this.proxyHandler()),this.debounceRender()},enumerable:!1,configurable:!0}),t.prototype.attach=function(t){"array"===this.trueTypeOf(t)?this.attached.concat(t):this.attached.push(t)},t.prototype.detach=function(e){var r="array"===this.trueTypeOf(e);this.attached=this.attached.filter(function(t){return r?-1===e.indexOf(t):t!==e})},t.prototype.debounceRender=function(){var t=this;this.debounce&&window.cancelAnimationFrame(this.debounce),this.debounce=window.requestAnimationFrame(function(){return t.render()})},t.prototype.trueTypeOf=function(t){return void 0===t?"undefined":null===t?"null":t.toString().slice(8,-1).toLowerCase()},t.prototype.proxyHandler=function(){var n=this;return{get:function(t,e){return-1<["object","array"].indexOf(n.trueTypeOf(t[e]))?new Proxy(t[e],n.proxyHandler()):t[e]},set:function(t,e,r){return t[e]===r||(t[e]=r,n.debounceRender()),!0},deleteProperty:function(t,e){return delete t[e],n.debounceRender(),!0}}},t.prototype.stringToHTML=function(t){return(new DOMParser).parseFromString(t,"text/html").body},t.prototype.getNodeType=function(t){return 3===t.nodeType?"text":8===t.nodeType?"comment":t.tagName.toLowerCase()},t.prototype.getNodeContent=function(t){return t.childNodes&&0<t.childNodes.length?null:t.textContent},t.prototype.getStyleMap=function(t){return t.split(";").reduce(function(t,e){var r=e.indexOf(":");return r&&t.push({name:e.slice(0,r).trim(),value:e.slice(r+1).trim()}),t},[])},t.prototype.removeStyles=function(e,t){t.forEach(function(t){return e.style[t]=""})},t.prototype.changeStyles=function(e,t){t.forEach(function(t){return e.style[t.name]=t.value})},t.prototype.diffStyles=function(r,t){var n=this.getStyleMap(t),e=d(r.style).filter(function(e){return void 0===n.find(function(t){return t.name===e&&t.value===r.style[e]})});this.removeStyles(r,e),this.changeStyles(r,n)},t.prototype.addAttributes=function(e,t){var r=this;t.forEach(function(t){if("class"===t.att)e.className=t.value;else if("style"===t.att)r.diffStyles(e,t.value);else{if(t.att in e)try{e[t.att]=t.value,e[t.att]||0===e[t.att]||(e[t.att]=!0)}catch(t){}try{e.setAttribute(t.att,t.value)}catch(t){}}})},t.prototype.removeAttributes=function(e,t){var r=this;t.forEach(function(t){if("class"===t.att)e.className="";else if("style"===t.att)r.removeStyles(e,d(e.style).slice());else{if(t.att in e)try{e[t.att]=""}catch(t){}try{e.removeAttribute(t.att)}catch(t){}}})},t.prototype.getDynamicAttributes=function(e,r,n){var a=this;this.dynamicAttributes.forEach(function(t){!e[t]&&0!==e[t]||n&&"option"===e.tagName.toLowerCase()&&"selected"===t||n&&"select"===e.tagName.toLowerCase()&&"value"===t||r.push(a.getAttribute(t,e[t]))})},t.prototype.getBaseAttributes=function(t,r){var n=this;return d(t.attributes).reduce(function(t,e){return!(n.dynamicAttributes.indexOf(e.name)<0||r&&"selected"===e.name)||7<e.name.length&&"default"===e.name.slice(0,7)||t.push(n.getAttribute(e.name,e.value)),t},[])},t.prototype.getAttribute=function(t,e){return{att:t,value:e}},t.prototype.getAttributes=function(t,e){if(1!==t.nodeType)return[];var r=this.getBaseAttributes(t,e);return this.getDynamicAttributes(t,r,e),r},t.prototype.diffAtts=function(t,e){var r=this,n=this.getAttributes(t,!0),a=this.getAttributes(e,!1),o=a.filter(function(e){return!(-1<r.dynamicAttributes.indexOf(e.att))&&void 0===n.find(function(t){return e.att===t.att})}),s=n.filter(function(e){var t=a.find(function(t){return e.att===t.att});return void 0===t||t.value!==e.value});this.addAttributes(e,s),this.removeAttributes(e,o)},t.prototype.addDefaultAtts=function(e){var r=this;1===e.nodeType&&(d(e.attributes).forEach(function(t){t.name.length<8||"default"!==t.name.slice(0,7)||(r.addAttributes(e,[r.getAttribute(t.name.slice(7).toLowerCase(),t.value)]),r.removeAttributes(e,[r.getAttribute(t.name,t.value)]))}),e.childNodes&&d(e.childNodes).forEach(function(t){return r.addDefaultAtts(t)}))},t.prototype.diffingDOM=function(t,a,o){var s=this,i=d(a.childNodes).slice(),e=d(t.childNodes).slice(),r=i.length-e.length;if(0<r)for(;0<r;r--)i[i.length-r].parentNode.removeChild(i[i.length-r]);e.forEach(function(e,t){if(!i[t])return s.addDefaultAtts(e),void a.appendChild(e.cloneNode(!0));if(s.getNodeType(e)===s.getNodeType(i[t])){if(s.diffAtts(e,i[t]),!(0<o.filter(function(t){return 3!==e.nodeType&&e.matches(t)}).length)){var r=s.getNodeContent(e);if(r&&r!==s.getNodeContent(i[t])&&(i[t].textContent=r),0<i[t].childNodes.length&&e.childNodes.length<1)i[t].innerHTML="";else{if(i[t].childNodes.length<1&&0<e.childNodes.length){var n=document.createDocumentFragment();return s.diffingDOM(e,n,o),void i[t].appendChild(n)}0<e.childNodes.length&&s.diffingDOM(e,i[t],o)}}}else i[t].parentNode.replaceChild(e.cloneNode(!0),i[t])})},t.prototype.renderAttachments=function(t){t&&t.forEach(function(t){"render"in t&&t.render()})},t.prototype.render=function(){var t=document.querySelector(this.elem),e=this.stringToHTML(this.template(this._data)),r=this.attached.map(function(t){return t.elem});this.diffingDOM(e,t,r),t.dispatchEvent(new CustomEvent("render",{bubbles:!0,detail:this._data})),this.renderAttachments(this.attached)},t);function t(t){var e=this;this.enabled=!1,this.dynamicAttributes=["checked","selected","value"],this.attached=[],this.elem=t.selector,this._data=new Proxy(t.data,this.proxyHandler()),this.template=t.template,this.debounce=0,t.attachTo&&("array"===this.trueTypeOf(t.attachTo)?t.attachTo:[t.attachTo]).forEach(function(t){return"attach"in t&&t.attach(e)})}var f=new u({selector:"#app",data:{showError:!1,showSuccess:!1,showDashboard:!0,showAlbum:!1,showImage:!1,currentAlbum:null,currentImage:null},template:function(t){return"\n\t<div id='loading-modal'></div>\n\t<header id=\"app-navbar\" class='header'></header>\n\t<main class=\"bg-gray-100 flex-grow\">\n\t\t<div class=\"container mx-auto p-4\">\n\t\t\t<section id='error-alert' class='mt-5 flex w-full justify-center items-center "+(t.showError?"":"hidden")+"'></section>\n\t\t\t<section id='success-alert' class='mt-5 flex w-full justify-center items-center "+(t.showSuccess?"":"hidden")+"'></section>\n\t\t\t<section id='dashboard-section' class=\""+(t.showDashboard?"":"hidden")+"\"></section>\n\t\t\t<section id='album-detail-section' class=\""+(t.showAlbum?"":"hidden")+"\"></section>\n\t\t\t<section id='image-detail-section' class=\""+(t.showImage?"":"hidden")+'"></section>\n\t\t</div>\n\t</main>\n'}}),e=new u({selector:"#dashboard-section",data:{},template:function(t){return'\n\t<div class="mt-6 w-full flex justify-center">\n\t\t<div id=\'add-album-section\' class="rounded p-2 shadow-xl flex flex-col justify-start bg-blue-600"></div>\n\t</div>\n\n\t<div class="my-6 w-full flex flex-wrap justify-center" >\n\t\t<div class="w-full mb-2 text-lg font-bold text-blue-500 border-b border-blue-500">Albums</div>\n\t\t<div class="w-full text-sm mb-4 text-gray-800">Drag and drop an album to sort it differently.</div>\n\t\t<section id="album-grid" class="w-full album-grid"></section>\n\t</div>\n'},attachTo:f}),a=new u({selector:"#app-navbar",data:{isLogged:!1},template:function(t){return'\n\t<nav>\n\t\t<div class="container mx-auto">\n\t\t\t<div class="w-full flex justify-between items-center">\n\t\t\t\t<a id="home-btn" href="'+c+'" class="brand-logo">Image Gallery</a>\n\t\t\t\t<div class="flex-grow ml-6">\n\t\t\t\t\t<a id="dashboard-nav" href="#" class="btn btn-blue">Dashboard</a>\n\t\t\t\t</div>\n\t\t\t\t<div class="flex">\n\t\t\t\t\t<a id="signout-btn" href="#" class="btn btn-blue">Sign Out</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</nav>\n'},attachTo:f}),i=new u({selector:"#add-album-section",data:{albumTitle:"",albumTitleError:"",genericError:!1},template:function(t){return'\n\t<div class="text-xl border-b-2 border-gray-200 mb-4 p-1 text-gray-200">Add New Album</div>\n\t<form id="add-album-form" action="#" class="flex justify-between items-center">\n\t\t<input id="add-album-title" type="text" maxlength="45" name="title" placeholder="Album Title" class="rounded p-2 flex-grow mr-4 '+(t.albumTitleError||t.genericError?"border-2 border-red-600 outline-none":"")+'" required />\n\t\t<input type="submit" class="bg-transparent text-gray-200 cursor-pointer outline-none btn btn-blue" value="Add" />\n\t</form>\n'},attachTo:e}),b=new u({selector:"#album-grid",data:{albums:[],attempted:!1},template:function(t){return t.albums.length?t.albums.sort(function(t,e){return e.order-t.order}).map(function(t){return'\n\t\t<div id="album-'+t.id+'" data-id="'+t.id+'" data-order="'+t.order+'" class="album cursor-pointer shadow-lg flex flex-col p-2 rounded items-stretch bg-white text-gray-800 transition-default hover:bg-blue-200" draggable="true">\n\t\t\t<div class="pointer-events-none border-b border-gray-800 p-2"><span class="font-bold">Album Title:</span> <span>'+t.title+'</span></div>\n\t\t\t<div class="pointer-events-none border-b border-gray-800 p-2"><span class="font-bold">Created:</span> <span>'+t.createdAt+"</span></div>\n\t\t</div>\n\t"}).join(""):'<div class="rounded shadow p-4 bg-yellow-500 text-gray-800 flex justify-center items-center" draggable="false">There are no albums to show. Add one using the form above.</div>'},attachTo:e}),g=new u({selector:"#error-alert",data:{message:""},template:function(t){return'\n\t<div class="w-full md:w-1/2" role="alert" >\n\t\t<div class="bg-red-500 text-white font-bold rounded-t px-4 py-2 flex justify-between">\n\t\t\t<span class="flex-grow font-bold">ERROR!</span>\n\t\t\t<button id=\'error-alert-delete\' class="alert-delete transition-default hover:text-red-800"><i class="fas fa-times pointer-events-none"></i></button>\n\t\t</div>\n\t\t<div class="border border-t-0 border-red-400 rounded-b bg-red-100 px-4 py-3 text-red-700">\n\t\t\t<p id="error-body">'+t.message+"</p>\n\t\t</div>\n\t</div>\n"}}),o=new u({selector:"#app",data:{showSuccess:!1,showError:!1},template:function(t){return'\n\t<header id="index-navbar" class=\'header\'></header>\n\t<main class="bg-gray-100 flex-grow">\n\t\t<div class="container mx-auto p-4">\n\t\t\t<section id=\'error-alert\' class=\'mt-5 flex w-full justify-center items-center '+(t.showError?"":"hidden")+"'></section>\n\t\t\t<section id='success-alert' class='mt-5 flex w-full justify-center items-center "+(t.showSuccess?"":"hidden")+"'></section>\n\t\t\t<section id='signin-section'></section>\n\t\t\t<section id='signup-section'></section>\n\t\t</div>\n\t</main>\n"}}),l=new u({selector:"#index-navbar",data:{isLogged:!1},template:function(t){return'\n\t<nav>\n\t\t<div class="container mx-auto">\n\t\t\t<div class="w-full flex justify-between items-center">\n\t\t\t\t<a id="home-btn" href="'+c+'" class="brand-logo">Image Gallery</a>\n\t\t\t\t<div class="flex-grow ml-6">\n\t\t\t\t\t<a id="dashboard-btn" href="#" class="btn btn-blue '+(t.isLogged?"":"hidden")+'">Dashboard</a>\n\t\t\t\t</div>\n\t\t\t\t<div class="flex">\n\t\t\t\t\t<a id="signout-btn" href="#" class="btn btn-blue '+(t.isLogged?"":"hidden")+'">Sign Out</a>\n\t\t\t\t\t<a id="signin-nav" href="#" class="btn btn-blue mr-3 '+(t.isLogged?"hidden":"")+'">Sign In</a>\n\t\t\t\t\t<a id="signup-nav" href="#" class="btn btn-blue '+(t.isLogged?"hidden":"")+'">Sign Up</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</nav>\n'},attachTo:o}),h=new u({selector:"#success-alert",data:{message:""},template:function(t){return'\n\t<div class="w-full md:w-1/2" role="alert" >\n\t\t<div class="bg-green-500 text-white font-bold rounded-t px-4 py-2 flex justify-between">\n\t\t\t<span class="flex-grow font-bold">SUCCESS!</span>\n\t\t\t<button id=\'error-alert-delete\' class="alert-delete transition-default hover:text-green-800"><i class="fas fa-times pointer-events-none"></i></button>\n\t\t</div>\n\t\t<div class="border border-t-0 border-green-400 rounded-b bg-green-100 px-4 py-3 text-green-700">\n\t\t\t<p id="success-body">'+t.message+"</p>\n\t\t</div>\n\t</div>\n"}});new u({selector:"#signup-section",data:{username:"",password:"",passwordConfirm:"",email:"",usernameError:"",passwordError:"",emailError:"",passwordConfirmError:"",genericError:!1},template:function(t){return'\n\t<div class="w-full flex justify-center">\n\t\t<div class="w-full md:w-1/2 mt-12 rounded p-4 shadow-xl flex flex-col bg-blue-600">\n\t\t\t<div class="text-xl border-b-2 border-gray-200 mb-8 p-2 text-gray-200">Sign Up</div>\n\t\t\t<form id="signup-form" action="#">\n\t\t\t\t<input id="username-signup" type="text" maxlength="45" name="username" placeholder="Username" class="w-full rounded p-2 mb-2 '+(t.usernameError||t.genericError?"border-2 border-red-600 outline-none":"")+'" required />\n\t\t\t\t<div id="username-signup-error" class="w-full mb-2 inline-flex px-2 text-sm text-red-600 rounded font-bold '+(t.usernameError?"":"hidden")+'" style="background: rgba(255, 255, 255, .5)">'+t.usernameError+'</div>\n\n\t\t\t\t<input id="email-signup" type="email" name="email" placeholder="Email" class="w-full rounded p-2 mb-2 '+(t.emailError||t.genericError?"border-2 border-red-600 outline-none":"")+'" required />\n\t\t\t\t<div id="email-signup-error" class="w-full mb-2 inline-flex px-2 text-sm text-red-600 rounded font-bold '+(t.emailError?"":"hidden")+'" style="background: rgba(255, 255, 255, .5)">'+t.emailError+'</div>\n\n\t\t\t\t<input id="password-signup" type="password" maxlength="45" name="password" placeholder="Password" class="w-full rounded p-2 mb-2 '+(t.passwordError||t.passwordConfirmError||t.genericError?"border-2 border-red-600 outline-none":"")+'" required />\n\t\t\t\t<div id="password-signup-error" class="w-full mb-2 inline-flex px-2 text-sm text-red-600 rounded font-bold '+(t.passwordError?"":"hidden")+'" style="background: rgba(255, 255, 255, .5)">'+t.passwordError+'</div>\n\n\t\t\t\t<input id="confirm-password-signup" type="password" maxlength="45" name="passwordCheck" placeholder="Confirm Password" class="flex w-full rounded p-2 mb-2 '+(t.passwordConfirmError||t.genericError?"border-2 border-red-600 outline-none":"")+'" required />\n\t\t\t\t<div id="confirm-password-error" class="w-full mb-2 inline-flex px-2 text-sm text-red-600 rounded font-bold '+(t.passwordConfirmError?"":"hidden")+'" style="background: rgba(255, 255, 255, .5)">'+t.passwordConfirmError+'</div>\n\n\t\t\t\t<input type="submit" class="bg-transparent text-gray-200 cursor-pointer outline-none btn btn-blue" value="Sign Up" />\n\t\t\t</form>\n\t\t</div>\n\t</div>\n'}}),new u({selector:"#signin-section",data:{username:"",password:"",usernameError:"",passwordError:"",genericError:!1,remember:!1},template:function(t){return'\n\t<div class="w-full flex justify-center">\n\t<div class="w-full md:w-1/2 mt-12 rounded p-4 shadow-xl flex flex-col bg-blue-600">\n\t\t<div class="text-xl border-b-2 border-gray-200 mb-8 p-2 text-gray-200">Sign In</div>\n\t\t<form id="signin-form" action="#">\n\t\t\t<input id="username-signin" type="text" name="username" placeholder="Username" class="w-full rounded p-2 mb-2 '+(t.usernameError||t.genericError?"border-2 border-red-600 outline-none":"")+'" required />\n\t\t\t<div id="username-signin-error" class="w-full mb-2 inline-flex px-2 text-sm text-red-800 font-bold '+(t.usernameError?"":"hidden")+'">'+t.usernameError+'</div>\n\n\t\t\t<input id="password-signin" type="password" name="password" placeholder="Password" class="w-full rounded p-2 mb-2 '+(t.passwordError||t.genericError?"border-2 border-red-600 outline-none":"")+'" required />\n\t\t\t<div id="password-signin-error" class="w-full mb-2 inline-flex px-2 text-sm text-red-800 font-bold '+(t.passwordError?"":"hidden")+'">'+t.passwordError+'</div>\n\t\t\t<div class="w-full mb-2 p-2">\n\t\t\t\t<label class="text-gray-200">\n\t\t\t\t\t<input class=\'mr-4\' type="checkbox" name="remember" id="remember-signin" '+(t.remember?"checked":"")+' />\n\t\t\t\t\tRemember me?\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t\t<input type="submit" class="bg-transparent text-gray-200 cursor-pointer outline-none btn btn-blue" value="Sign In" />\n\t\t</form>\n\t</div>\n\t</div>\n'}});function p(e,t){var r=new u({selector:"#album-detail-section",data:{album:e,images:t,imageForm:null,imageGrid:null},template:function(t){return'\n\t\t<div id="album-section-title" class="mt-2 w-full flex justify-center items-center text-3xl font-semibold text-blue-800">'+e.title+"</div>\n\t\t<div id='add-image-section' class=\"mt-6 w-full flex justify-center\"></div>\n\t\t<div class=\"my-6 w-full flex flex-wrap justify-between items-center\">\n\t\t\t\t<div class=\"w-full mb-4 text-lg font-bold text-blue-500 border-b border-blue-500\">Images</div>\n\t\t\t\t<div id='image-grid' class='w-full flex justify-between items-center'></div>\n\t\t</div>\n\t"},attachTo:f});r.render();var n,a,o=(n=r.data.album.id,(a=new u({selector:"#add-image-section",data:{albumId:n,file:null,description:"",title:""},template:function(t){return'\n\t\t<div class="rounded p-2 shadow-xl flex flex-col bg-blue-600">\n\t\t\t<div class="text-xl border-b-2 border-gray-200 mb-4 py-1 px-8 text-gray-200">Add Image</div>\n\t\t\t<form id="add-image-form" action="#" class="flex flex-col">\n\t\t\t\t\t<input id="add-image-file" type="file" name="imageFile" placeholder="Image File" class="cursor-pointer rounded p-2 mb-2 text-gray-800 bg-white" required />\n\t\t\t\t\t<input id="add-image-title" type="text" maxlength="45" name="title" placeholder="Image Title" class="rounded p-2 mb-2" required />\n\t\t\t\t\t<textarea style="resize: none" id="add-image-description" type="text" rows="4" maxlength="255" name="description" placeholder="Image Description" class="rounded p-2 mb-2" required></textarea>\n\t\t\t\t\t<input type="submit" class="bg-transparent text-gray-200 cursor-pointer outline-none btn btn-blue" value="Add" />\n\t\t\t</form>\n\t\t</div>\n\t'},attachTo:r})).render(),a);r.data.imageForm=o;var s,i,d=(s=r.data.images,(i=new u({selector:"#image-grid",data:{images:s,page:1},template:function(r){return r.images.length?'\n\t\t<div class="mr-4 '+(1<r.page?"":"hidden")+'">\n\t\t\t<a id="prev-page-btn" href="#" class="text-gray-800 transition-default hover:text-blue-500 text-4xl">\n\t\t\t\t<i class="fas fa-chevron-circle-left pointer-events-none"></i>\n\t\t\t</a>\n\t\t</div>\n\t\t<div class=\'flex-grow image-grid\'>\n\t\t\t'+r.images.sort(function(t,e){return new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()}).map(function(t,e){return'\n\t\t\t\t<div id="image-'+t.id+'" data-id="'+t.id+'" class="image cursor-pointer shadow-lg flex flex-col p-2 rounded items-center bg-white text-gray-800 transition-default hover:bg-blue-200 '+(e<5*r.page&&e>=5*r.page-5?"":"hidden")+'">\n\t\t\t\t\t<div class="pointer-events-none rounded-full flex w-24 h-24 overflow-hidden">\n\t\t\t\t\t\t<img src="/resources/images/thumbnail_'+t.path+'" alt="'+t.title+'" style="object-fit: cover" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pointer-events-none border-b border-gray-800 text-gray-800 self-stretch text-center mt-2">\n\t\t\t\t\t\t<span class="font-bold">Title:</span> <span>'+t.title+"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"}).join("")+'\n\t\t</div>\n\t\t<div class="ml-4 '+(r.page<s.length/5?"":"hidden")+'">\n\t\t\t<a id="next-page-btn" href="#" class="text-gray-800 transition-default hover:text-blue-500 text-4xl">\n\t\t\t\t<i class="fas fa-chevron-circle-right pointer-events-none"></i>\n\t\t\t</a>\n\t\t</div>\n\t':'\n\t\t<div class="w-full rounded shadow p-4 bg-yellow-500 text-gray-800 flex justify-center items-center">No images to show! Add one using the form above.</div>\n\t'},attachTo:r})).render(),i);return r.data.imageGrid=d,r}var v=new u({selector:"#loading-modal",data:{showModal:!1,text:""},template:function(t){return t.showModal?"\n\t<div class='w-full h-full fixed block top-0 left-0 bg-white opacity-75 z-50'>\n\t\t<div class='flex justify-center items-center flex-col h-full w-full'>\n\t\t\t<div class='text-red-800 font-bold text-xl mb-5'>"+t.text+'</div>\n\t\t\t<span class="text-red-800 text-5xl">\n\t\t\t\t\t<i class="fas fa-circle-notch fa-spin"></i>\n\t\t\t\t</span>\n\t\t</div>\n\t</div>\n':""},attachTo:f});var w=function(t,s,i,d){return new(i=i||Promise)(function(r,e){function n(t){try{o(d.next(t))}catch(t){e(t)}}function a(t){try{o(d.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(n,a)}o((d=d.apply(t,s||[])).next())})},y=function(r,n){var a,o,s,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(a)throw new TypeError("Generator is already executing.");for(;i;)try{if(a=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return i.label++,{value:e[1],done:!1};case 5:i.label++,o=e[1],e=[0];continue;case 7:e=i.ops.pop(),i.trys.pop();continue;default:if(!(s=0<(s=i.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){i=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){i.label=e[1];break}if(6===e[0]&&i.label<s[1]){i.label=s[1],s=e;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(e);break}s[2]&&i.ops.pop(),i.trys.pop();continue}e=n.call(r,i)}catch(t){e=[6,t],o=0}finally{a=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},x=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,a,o=r.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)s.push(n.value)}catch(t){a={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(a)throw a.error}}return s},E=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(x(arguments[e]));return t},S=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function A(o){return w(this,void 0,void 0,function(){var e,r,n,a;return y(this,function(t){switch(t.label){case 0:if(!o.target.matches("#album-grid")||b.data.attempted)return[2];b.data.attempted=!0,t.label=1;case 1:return t.trys.push([1,9,,10]),[4,fetch(c+"/albums")];case 2:switch(e=t.sent(),e.status){case 200:return[3,3];case 500:return[3,5]}return[3,7];case 3:return[4,e.json()];case 4:return r=t.sent(),b.data.albums=E(r),s(document.getElementById("album-grid"),function(){return function(){return w(this,void 0,void 0,function(){var e,r,n,a,o,s,i;return y(this,function(t){switch(t.label){case 0:e=function(e){var r,n,a,o,s,i;return y(this,function(t){switch(t.label){case 0:r=e.dataset.id,n=e.dataset.order,(a=new FormData).append("albumId",r),a.append("newOrder",n),b.data.albums.find(function(t){return t.id===parseInt(r)}).order=parseInt(n),t.label=1;case 1:return t.trys.push([1,6,,7]),[4,fetch(c+"/albums",{method:"PUT",body:a})];case 2:return 200===(o=t.sent()).status?[3,4]:[4,o.json()];case 3:return s=t.sent(),g.data.message="OPS! Something went wrong! "+s.error,f.data.showError=!0,f.attach(g),[2,"continue"];case 4:return[4,o.json()];case 5:return t.sent(),[3,7];case 6:return i=t.sent(),g.data.message="Something went wrong! Possible network error!",f.data.showError=!0,f.attach(g),console.error(i),[3,7];case 7:return[2]}})},t.label=1;case 1:t.trys.push([1,6,7,8]),r=S(document.getElementById("album-grid").children),n=r.next(),t.label=2;case 2:return n.done?[3,5]:(a=n.value,[5,e(a)]);case 3:t.sent(),t.label=4;case 4:return n=r.next(),[3,2];case 5:return[3,8];case 6:return o=t.sent(),s={error:o},[3,8];case 7:try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(s)throw s.error}return[7];case 8:return[2]}})})}()}),[2];case 5:return[4,e.json()];case 6:return n=t.sent(),g.data.message="OPS! Something went wrong! "+n.error,f.data.showError=!0,f.attach(g),[2];case 7:return[3,8];case 8:return[3,10];case 9:return a=t.sent(),g.data.message="Something went wrong! Possible network error!",f.data.showError=!0,f.attach(g),console.error(a),[3,10];case 10:return[2]}})})}function j(d){var l;return w(this,void 0,void 0,function(){var r,n,a,o,s,i;return y(this,function(t){switch(t.label){case 0:if(!("matches"in(r=d.target)&&r.matches(".image")))return[2];if(void 0===(n=null===(l=f.data.currentAlbum)||void 0===l?void 0:l.data.images.find(function(t){return t.id===parseInt(r.dataset.id)})))return[2];t.label=1;case 1:return t.trys.push([1,9,,10]),[4,fetch(c+"/comments?imageId="+n.id)];case 2:switch(o=t.sent(),o.status){case 200:return[3,3];case 400:case 500:return[3,5]}return[3,7];case 3:return[4,o.json()];case 4:return a=t.sent(),(e=new u({selector:"#image-detail-section",data:{image:n,comments:a,commentBody:"",commentBodyError:!1},template:function(t){return'\n\t\t<div id=\'image-detail-modal\' class=\'w-full h-full flex justify-center items-center fixed block top-0 left-0 z-50\' style="background: rgba(0, 0, 0, .45)">\n\t\t\t<div class=\'p-8 rounded w-11/12 flex flex-col md:flex-row justify-between text-gray-800 bg-gray-100\' style="max-height: 90vh;">\n\t\t\t\t<div class="w-full md:w-2/3 flex flex-col justify-between">\n\t\t\t\t\t<div class="rounded p-2 shadow-lg bg-white flex flex-col justify-start mb-5">\n\t\t\t\t\t\t<div class="border-b border-gray-500 p-1 flex justify-start items-center">\n\t\t\t\t\t\t\t<span class="font-bold">Title:</span>&nbsp;\n\t\t\t\t\t\t\t<span>'+t.image.title+'</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="border-b border-gray-500 p-1 flex justify-start items-center">\n\t\t\t\t\t\t\t<span class="font-bold">Description:</span>&nbsp;\n\t\t\t\t\t\t\t<span>'+t.image.description+'</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="border-b border-gray-500 p-1 flex justify-start items-center">\n\t\t\t\t\t\t\t<span class="font-bold">Created:</span>&nbsp;\n\t\t\t\t\t\t\t<span>'+t.image.createdAt+'</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="flex-grow rounded overflow-hidden shadow-lg flex justify-center items-center bg-white">\n\t\t\t\t\t\t<img class=\'w-full h-full\' src="/resources/images/'+t.image.path+'" alt="'+t.image.title+'" style="object-fit: contain;">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="mt-5 md:mt-0 md:ml-5 w-full md:w-1/3 flex flex-col justify-between items-stretch rounded shadow-lg bg-white">\n\t\t\t\t\t<div class="relative flex-grow flex flex-col justify-start border-b border-black-800 overflow-auto">\n\t\t\t\t\t\t<div class="rounded bg-white sticky top-0 z-40 flex justify-start items-center border-b border-black-800 p-4 font-bold mb-2">Comments</div>\n\t\t\t\t\t\t<div class="flex-grow overflow-y-auto overflow-x-hidden absolute mt-12 w-11/12 p-4">\n\t\t\t\t\t\t\t'+t.comments.map(function(t){return'\n\t\t\t\t\t\t\t\t<div class="rounded py-1 px-2 w-full flex flex-col bg-blue-200 mb-1">\n\t\t\t\t\t\t\t\t\t<div style="word-break: break-word;overflow-wrap:break-word">'+t.comment.body+'</div>\n\t\t\t\t\t\t\t\t\t<div class="text-sm italic font-semibold">\n\t\t\t\t\t\t\t\t\t\t- '+t.username+" ("+new Date(t.comment.createdAt).toLocaleString()+")\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t"}).join("")+'\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="flex p-4">\n\t\t\t\t\t\t<form id=\'add-comment-form\' class="w-full flex justify-between" action="#">\n\t\t\t\t\t\t\t<input id=\'add-comment-body\' type="text" name="add-comment-body" placeholder="Write here..." class="flex-grow rounded p-2 bg-gray-200 '+(t.commentBodyError?"border-2 border-red-600 outline-none text-red-600":"")+'" required />\n\t\t\t\t\t\t\t<input type="submit" class="bg-transparent text-gray-800 cursor-pointer outline-none btn btn-blue ml-2" value="Send" required />\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'},attachTo:f})).render(),f.data.currentImage=e,f.data.showImage=!0,[2];case 5:return[4,o.json()];case 6:return s=t.sent(),g.data.message="Something went wrong! "+s.error,f.data.showError=!0,f.attach(g),[2];case 7:return[2];case 8:return[3,10];case 9:return i=t.sent(),g.data.message="Something went wrong! Possible network error!",f.data.showError=!0,f.attach(g),console.error(i),[3,10];case 10:return[2]}var e})})}document.addEventListener("DOMContentLoaded",function(){!function(){if(null!==sessionStorage.getItem("user"))return 1;if(null!==localStorage.getItem("user")){var t=JSON.parse(localStorage.getItem("user"));if((new Date).getTime()<t.expiry)return 1;localStorage.removeItem("user")}}()&&(window.location.href=c),document.addEventListener("render",function(t){A(t)}),document.addEventListener("click",function(t){t.target.matches("#success-alert-delete")&&(!l.data.isLogged&&a.data.isLogged?(f.data.showSuccess=!1,f.detach(h)):(o.data.showSuccess=!1,o.detach(h))),t.target.matches("#error-alert-delete")&&(!l.data.isLogged&&a.data.isLogged?(f.data.showError=!1,f.detach(g)):(o.data.showError=!1,o.detach(g))),function(r){w(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:if(!r.target.matches("#signout-btn"))return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,fetch(c+"/signout")];case 2:return 200===t.sent().status?(sessionStorage.removeItem("user"),localStorage.removeItem("user"),h.data.message="You successfully signed out!",f.data.showSuccess=!0,f.attach(h),window.location.href=c):(g.data.message="Something went wrong!",f.data.showError=!0,f.attach(g)),[3,4];case 3:return e=t.sent(),g.data.message="Something went wrong! Possible network error!",f.data.showError=!0,f.attach(g),console.error(e),[3,4];case 4:return[2]}})})}(t),t.target.matches("#dashboard-nav")&&(f.data.showDashboard=!0,f.data.showAlbum=!1,f.data.currentAlbum=null),function(l){w(this,void 0,void 0,function(){var e,r,n,a,o,s,i,d;return y(this,function(t){switch(t.label){case 0:if(!(e=l.target).matches(".album"))return[2];r=parseInt(e.dataset.id),n=b.data.albums.find(function(t){return t.id===r}),t.label=1;case 1:return t.trys.push([1,9,,10]),[4,fetch(c+"/images?albumId="+r)];case 2:switch(o=t.sent(),o.status){case 200:return[3,3];case 400:case 500:return[3,5]}return[3,7];case 3:return[4,o.json()];case 4:return a=t.sent(),s=p(n,a),f.data.currentAlbum=s,f.data.showDashboard=!1,f.data.showAlbum=!0,[2];case 5:return[4,o.json()];case 6:return i=t.sent(),g.data.message="Something went wrong! "+i.error,f.data.showError=!0,f.attach(g),[2];case 7:return[3,8];case 8:return[3,10];case 9:return d=t.sent(),g.data.message="Something went wrong! Possible network error!",f.data.showError=!0,f.attach(g),console.error(d),[3,10];case 10:return[2]}})})}(t),t.target.matches("#prev-page-btn")&&f.data.currentAlbum&&f.data.currentAlbum.data.imageGrid&&--f.data.currentAlbum.data.imageGrid.data.page,t.target.matches("#next-page-btn")&&f.data.currentAlbum&&f.data.currentAlbum.data.imageGrid&&(f.data.currentAlbum.data.imageGrid.data.page+=1),t.target.matches("#image-detail-modal")&&(f.data.showImage=!1,f.data.currentImage=null)}),document.addEventListener("submit",function(t){!function(s){w(this,void 0,void 0,function(){var e,r,n,a,o;return y(this,function(t){switch(t.label){case 0:if(!s.target.matches("#add-album-form"))return[2];s.preventDefault(),(e=new FormData).append("title",i.data.albumTitle),t.label=1;case 1:return t.trys.push([1,9,,10]),[4,fetch(c+"/albums",{method:"post",body:e})];case 2:switch(r=t.sent(),r.status){case 200:return[3,3];case 400:case 500:return[3,5]}return[3,7];case 3:return[4,r.json()];case 4:return n=t.sent(),b.data.albums.push(n),i.data.albumTitle="",i.data.albumTitleError="",i.data.genericError=!1,document.querySelector("#add-album-form").reset(),b.render(),[2];case 5:return[4,r.json()];case 6:return a=t.sent(),i.data.genericError=!0,g.data.message=a.error,f.data.showError=!0,f.attach(g),[2];case 7:return[3,8];case 8:return[3,10];case 9:return o=t.sent(),g.data.message="Something went wrong! Possible network error!",f.data.showError=!0,f.attach(g),console.error(o),[3,10];case 10:return[2]}})})}(t),function(i){var d;w(this,void 0,void 0,function(){var e,r,n,a,o,s;return y(this,function(t){switch(t.label){case 0:if(!i.target.matches("#add-image-form"))return[2];if(i.preventDefault(),v.data.showModal=!0,v.data.text="Uploading image...",document.querySelector("body").style.pointerEvents="none",!f.data.currentAlbum||!f.data.currentAlbum.data.imageForm)return[2];e=f.data.currentAlbum.data.imageForm,(r=new FormData).append("albumId",e.data.albumId.toString()),r.append("title",e.data.title),r.append("description",e.data.description),r.append("imageFile",e.data.file,null===(d=e.data.file)||void 0===d?void 0:d.name),t.label=1;case 1:return t.trys.push([1,9,,10]),[4,fetch(c+"/images",{method:"post",body:r})];case 2:switch(n=t.sent(),n.status){case 200:return[3,3];case 400:case 500:return[3,5]}return[3,7];case 3:return[4,n.json()];case 4:return a=t.sent(),f.data.currentAlbum.data.images.push(a),f.data.currentAlbum.render(),e.data.description="",e.data.title="",e.data.file=null,document.querySelector("#add-image-form").reset(),v.data.showModal=!1,document.querySelector("body").style.pointerEvents="auto",f.data.currentAlbum.data.imageGrid.data.page=1,[2];case 5:return[4,n.json()];case 6:return o=t.sent(),g.data.message="Something went wrong! "+o.error,f.data.showError=!0,f.attach(g),v.data.showModal=!1,document.querySelector("body").style.pointerEvents="auto",[2];case 7:return[2];case 8:return[3,10];case 9:return s=t.sent(),g.data.message="Something went wrong! Possible network error!",f.data.showError=!0,f.attach(g),v.data.showModal=!1,document.querySelector("body").style.pointerEvents="auto",console.error(s),[3,10];case 10:return[2]}})})}(t),function(i){w(this,void 0,void 0,function(){var e,r,n,a,o,s;return y(this,function(t){switch(t.label){case 0:if(!i.target.matches("#add-comment-form"))return[2];if(!f.data.currentImage)return[2];if(i.preventDefault(),""===(e=f.data.currentImage).data.commentBody.trim())return e.data.commentBodyError=!0,document.querySelector("#add-comment-body").value="You cannot send empty message!",[2];r=new FormData,console.log(e.data.commentBody),r.append("body",e.data.commentBody),r.append("imageId",e.data.image.id.toString()),t.label=1;case 1:return t.trys.push([1,9,,10]),[4,fetch(c+"/comments",{method:"post",body:r})];case 2:switch(n=t.sent(),n.status){case 200:return[3,3];case 400:case 500:return[3,5]}return[3,7];case 3:return[4,n.json()];case 4:return a=t.sent(),e.data.comments.push(a),e.render(),e.data.commentBody="",document.querySelector("#add-comment-form").reset(),[2];case 5:return[4,n.json()];case 6:return o=t.sent(),g.data.message="Something went wrong! "+o.error,f.data.showError=!0,f.attach(g),f.data.showImage=!1,f.data.currentImage=null,[2];case 7:return[3,8];case 8:return[3,10];case 9:return s=t.sent(),g.data.message="Something went wrong! Possible network error!",f.data.showError=!0,f.attach(g),f.data.showImage=!1,f.data.currentImage=null,console.error(s),[3,10];case 10:return[2]}})})}(t)}),document.addEventListener("focusin",function(t){var e;(e=t.target).matches("#add-comment-body")&&f.data.currentImage&&f.data.currentImage.data.commentBodyError&&(e.value="",f.data.currentImage.data.commentBodyError=!1)}),document.addEventListener("change",function(t){var e,r,n,a,o;(e=t.target).matches("#add-album-title")&&(i.data.albumTitle=e.value),(r=t.target).matches("#add-image-file")&&f.data.currentAlbum&&f.data.currentAlbum.data.imageForm&&null!==r.files&&(f.data.currentAlbum.data.imageForm.data.file=r.files[0]),(n=t.target).matches("#add-image-title")&&f.data.currentAlbum&&f.data.currentAlbum.data.imageForm&&(f.data.currentAlbum.data.imageForm.data.title=n.value),(a=t.target).matches("#add-image-description")&&f.data.currentAlbum&&f.data.currentAlbum.data.imageForm&&(f.data.currentAlbum.data.imageForm.data.description=a.value),(o=t.target).matches("#add-comment-body")&&f.data.currentImage&&(f.data.currentImage.data.commentBody=o.value)}),document.addEventListener("mouseover",function(t){j(t)}),a.data.isLogged=!0,f.render(),v.render(),a.render(),e.render(),i.render(),b.render()})}();
